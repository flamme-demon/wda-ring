(()=>{"use strict";var e={7:e=>{var t,s="object"==typeof Reflect?Reflect:null,i=s&&"function"==typeof s.apply?s.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)};t=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(s,i){function n(s){e.removeListener(t,a),i(s)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",n),s([].slice.call(arguments))}f(e,t,a,{once:!0}),"error"!==t&&function(e,t,s){"function"==typeof e.on&&f(e,"error",t,{once:!0})}(e,n)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function r(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,s,i){var n,a,o,h;if(r(s),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,s.listener?s.listener:s),a=e._events),o=a[t]),void 0===o)o=a[t]=s,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[s,o]:[o,s]:i?o.unshift(s):o.push(s),(n=l(e))>0&&o.length>n&&!o.warned){o.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=o.length,h=d,console&&console.warn&&console.warn(h)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,s){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},n=d.bind(i);return n.listener=s,i.wrapFn=n,n}function u(e,t,s){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?s?[n.listener||n]:[n]:s?function(e){for(var t=new Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}(n):p(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var s=t[e];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function p(e,t){for(var s=new Array(t),i=0;i<t;++i)s[i]=e[i];return s}function f(e,t,s,i){if("function"==typeof e.on)i.once?e.once(t,s):e.on(t,s);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(a){i.once&&e.removeEventListener(t,n),s(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var n="error"===e,a=this._events;if(void 0!==a)n=n&&void 0===a.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var r=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw r.context=o,r}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var h=l.length,d=p(l,h);for(s=0;s<h;++s)i(d[s],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return r(t),this.on(e,c(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return r(t),this.prependListener(e,c(this,e,t)),this},a.prototype.removeListener=function(e,t){var s,i,n,a,o;if(r(t),void 0===(i=this._events))return this;if(void 0===(s=i[e]))return this;if(s===t||s.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,s.listener||t));else if("function"!=typeof s){for(n=-1,a=s.length-1;a>=0;a--)if(s[a]===t||s[a].listener===t){o=s[a].listener,n=a;break}if(n<0)return this;0===n?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,n),1===s.length&&(i[e]=s[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,s,i;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[e]),this;if(0===arguments.length){var n,a=Object.keys(s);for(i=0;i<a.length;++i)"removeListener"!==(n=a[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=s[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return u(this,e,!0)},a.prototype.rawListeners=function(e){return u(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},893:(e,t,s)=>{e.exports=s.p+"manifest.json"}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=i[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e+"../../"})(),(()=>{const e="wazo/EVENT_APP_INITIALIZE",t="wazo/mobile/EVENT_MOBILE_ON_MENU_ACTION";class i{constructor(){if(this.onNewSession=e=>{},this.onUnLoaded=e=>{},this.onPluginUnLoaded=()=>{},this.onAppUnLoaded=e=>{},this.onIframeMessage=e=>{},this.onBackgroundMessage=e=>{},this.onLogout=()=>{},this.onCallIncoming=e=>{},this.onCallMade=e=>{},this.onCallAnswered=e=>{},this.onCallAccepted=e=>{},this.onCallHungUp=e=>{},this.onUnHandledEvent=e=>{},this.onWebsocketMessage=e=>{},this.onMeetingCreated=e=>{},this.onRouteChanged=(e,t)=>{},this.onUserJoinRoom=e=>{},this.onUserLeaveRoom=e=>{},this.onParticipantJoinRoom=(e,t)=>{},this.onParticipantLeaveRoom=(e,t)=>{},this.onConnectedToStack=e=>{},this.onSwitchTenant=(e,t)=>{},this.initialize=async()=>this.isInitialized()?Promise.resolve():(window.addEventListener("message",this._onMessage,!1),new Promise(((t,s)=>{this._sendMessage(e,{bg:this._isBackground,pluginId:this._pluginId}),this._initializeTimeout=setTimeout((()=>{this._initializeTimeout=null,s("SDK initialize timeout")}),5e3),this._initializeResolve=t}))),this.isInitialized=()=>this._initializeCompleted,this.getContext=()=>this.context,this.sendMessageToIframe=e=>this._sendMessage("wazo/EVENT_SEND_IFRAME_MESSAGE",{payload:e}),this.sendMessageToBackground=e=>this._sendMessage("wazo/EVENT_SEND_BACKGROUND_MESSAGE",{payload:e}),this.startCall=({targets:e,requestedModalities:t=["audio"]})=>{this._sendMessage("wazo/START_CALL",{targets:e,requestedModalities:t})},this.openLink=e=>{this._sendMessage("wazo/EVENT_OPEN_LINK",{url:e})},this.createMeeting=(e,t=!1,s=!1)=>{this._sendMessage("wazo/EVENT_CREATE_MEETING",{name:e,requireAuthorization:t,persistent:s})},this.openMeetingLobby=e=>{this._sendMessage("wazo/EVENT_OPEN_MEETING_LOBBY",{extension:e})},this.openSettings=()=>{},this.closeLeftPanel=()=>this._sendMessage("wazo/EVENT_CLOSE_LEFT_PANEL"),this.openLeftPanel=()=>this._sendMessage("wazo/EVENT_OPEN_LEFT_PANEL"),this.playProgressSound=()=>this._sendMessage("wazo/EVENT_PLAY_PROGRESS_SOUND"),this.playNewMessageSound=()=>this._sendMessage("wazo/EVENT_PLAY_NEW_MESSAGE_SOUND"),this.playIncomingCallSound=()=>this._sendMessage("wazo/EVENT_PLAY_INCOMING_CALL_SOUND"),this.playDoubleCallSound=()=>this._sendMessage("wazo/EVENT_PLAY_DOUBLE_CALL_SOUND"),this.playHangupSound=()=>this._sendMessage("wazo/EVENT_PLAY_HANGUP_SOUND"),this.stopCurrentSound=()=>this._sendMessage("wazo/EVENT_STOP_CURRENT_SOUND"),this.configureSounds=e=>this._sendMessage("wazo/EVENT_CONFIGURE_SOUNDS",{sounds:e}),this.resetSounds=()=>this._sendMessage("wazo/EVENT_RESET_SOUNDS"),this.changeNavBarColor=e=>this._sendMessage("wazo/EVENT_CHANGE_NAVBAR_COLOR",{color:e}),this.resetNavBarColor=()=>this._sendMessage("wazo/EVENT_RESET_NAVBAR_COLOR"),this.displayNotification=(e,t)=>this._sendMessage("wazo/EVENT_DISPLAY_NOTIFICATION",{title:e,text:t}),this.displayModal=({url:e,title:t,text:s,htmlText:i,height:n,width:a,hideCloseButton:o})=>this._sendMessage("wazo/EVENT_DISPLAY_MODAL",{url:e,title:t,text:s,htmlText:i,height:n,width:a,hideCloseButton:o}),this.removeModal=()=>this._sendMessage("wazo/EVENT_REMOVE_MODAL"),this.hasLocalVideoStream=e=>Wazo.Phone.phone.hasALocalVideoTrack(e),this.getLocalCurrentVideoStream=e=>Wazo.Phone.phone.getLocalVideoStream(e),this.hasRemoveVideoStream=e=>Wazo.Phone.phone.hasRemoteVideo(e),this.getRemoteVideoStream=e=>Wazo.Phone.phone.getRemoteVideoStream(e),this.updateBadge=e=>this._sendMessage("wazo/EVENT_UPDATE_BADGE",{...e,entityId:e.entityId||this._entityId||"update-badge-null-entity-id"}),this.displayBanner=e=>this._sendMessage("wazo/EVENT_DISPLAY_BANNER",{...e,entityId:this._entityId||"display-banner-null-entity-id"}),this.closeBanner=()=>this._sendMessage("wazo/EVENT_REMOVE_BANNER",{entityId:this._entityId||"remove-banner-null-entity-id"}),this.changeToolbarDisplay=e=>this._sendMessage("wazo/EVENT_CHANGE_TOOLBAR_DISPLAY",{display:e}),this.setMobileHeader=({title:e,callback:t},s)=>{const i=s||this._entityId;i&&(delete this._headerBackCallbacks[i],"function"==typeof t&&(this._headerBackCallbacks[i]=t)),this._sendMessage("wazo/mobile/EVENT_MOBILE_HEADER",{headerTitle:e,emitHeaderBack:!!t,entityId:s||this._entityId})},this.setMobileContextualMenu=(e,t)=>this._sendMessage("wazo/mobile/EVENT_MOBILE_CONTEXTUAL_MENU",{contextualMenu:e,entityId:t||this._entityId}),this.setMobileShowBottomNav=(e,t)=>this._sendMessage("wazo/mobile/EVENT_MOBILE_SHOW_BOTTOM_NAV",{showBottomNav:e,entityId:t||this._entityId}),this.onMobileMenuAction=e=>this.sendMessageToIframe({type:t,id:e}),this._onMessage=e=>{if(e.data)switch(e.data.type){case"wazo/ON_LOADED":this._onLoaded(e.data.session,e.data.theme,e.data.locale,e.data.extra);break;case"wazo/EVENT_APP_UNLOADED":delete this._headerBackCallbacks[e.data.tabId],this.onAppUnLoaded(e.data.tabId);break;case"wazo/EVENT_PLUGIN_UNLOADED":this._unloadPlugin();break;case"wazo/EVENT_ON_LOGOUT":this.onLogout(),this._unloadPlugin();break;case"wazo/EVENT_ON_NEW_SESSION":this.onNewSession(e.data.session);break;case"wazo/EVENT_ON_IFRAME_MESSAGE":e.data._pluginId===this._pluginId&&this.onIframeMessage(e.data.payload);break;case"wazo/EVENT_ON_BACKGROUND_MESSAGE":e.data._pluginId===this._pluginId&&this.onBackgroundMessage(e.data.payload);break;case"wazo/EVENT_USER_JOIN_ROOM":this.onUserJoinRoom(e.data.room);break;case"wazo/EVENT_USER_LEAVE_ROOM":this.onUserLeaveRoom(e.data.room);break;case"wazo/EVENT_PARTICIPANT_JOIN_ROOM":this.onParticipantJoinRoom(e.data.room,e.data.participant);break;case"wazo/EVENT_PARTICIPANT_LEAVE_ROOM":this.onParticipantLeaveRoom(e.data.room,e.data.participant);break;case"wazo/EVENT_WS_MESSAGE":this.onWebsocketMessage(e.data.message);break;case"wazo/EVENT_ON_MEETING_CREATED":this.onMeetingCreated(e.data.meeting);break;case"wazo/EVENT_ROUTE_CHANGE":this.onRouteChanged(e.data.location,e.data.action);break;case"wazo/EVENT_ON_CALL_INCOMING":this.onCallIncoming(e.data.call);break;case"wazo/EVENT_ON_CALL_MADE":this.onCallMade(e.data.call);break;case"wazo/EVENT_ON_CALL_ANSWERED":this.onCallAnswered(e.data.call);break;case"wazo/EVENT_ON_CALL_ACCEPTED":this.onCallAccepted(e.data.call);break;case"wazo/EVENT_ON_CALL_HUNG_UP":this.onCallHungUp(e.data.call);break;case"wazo/EVENT_ON_CONNECTED_TO_STACK":this.onConnectedToStack(e.data.stackSession);break;case"wazo/EVENT_ON_SWITCH_STACK_TENANT":this.onSwitchTenant(e.data.tenant.uuid,e.data.tenant.name);break;case"wazo/mobile/EVENT_MOBILE_ON_HEADER_BACK":const s=this._headerBackCallbacks[e.data.entityId||this._entityId];"function"==typeof s&&s();break;case t:this.onMobileMenuAction(e.data);break;default:this.onUnHandledEvent(e)}},this._sendMessage=(t,s={})=>{if(this.isInitialized()||t===e)return window.ReactNativeWebView?window.ReactNativeWebView.postMessage(JSON.stringify({type:t,_pluginId:this._pluginId,_entityId:this._entityId,...s})):void window.parent.postMessage({type:t,_pluginId:this._pluginId,_entityId:this._entityId,...s},"*");this._queuedMessages.push({type:t,payload:s})},this._sendQueuedMessages=()=>{this._queuedMessages.forEach((({type:e,payload:t})=>{this._sendMessage(e,t)}))},this._onLoaded=(e,t,s,i)=>{null===this._initializeTimeout||this.isInitialized()||(clearTimeout(this._initializeTimeout),this._initializeCompleted=!0,this.context.app={locale:s,theme:t,host:{clientType:i?i.clientType:null},extra:{...i,baseUrl:this._baseUrl,pluginId:this._pluginId}},this.context.user=e,this._initializeResolve&&this._initializeResolve(),this._sendQueuedMessages())},this._setPluginId=e=>{this._pluginId=e},this._unloadPlugin=()=>{this.onPluginUnLoaded(),this._resetEvents()},this._configurePlugin=e=>{e.pluginId&&(this._pluginId=e.pluginId),e.baseUrl&&(this._baseUrl=e.baseUrl),e.entityId&&(this._entityId=e.entityId)},this._resetEvents=()=>{this.onUnLoaded=e=>{},this.onPluginUnLoaded=()=>{},this.onAppUnLoaded=e=>{},this.onIframeMessage=e=>{},this.onBackgroundMessage=e=>{},this.onLogout=()=>{},this.onNewSession=e=>{},this.onCallIncoming=e=>{},this.onCallMade=e=>{},this.onCallAnswered=e=>{},this.onCallAccepted=e=>{},this.onCallHungUp=e=>{},this.onUnHandledEvent=e=>{},this.onWebsocketMessage=e=>{},this.onMeetingCreated=e=>{},this.onRouteChanged=(e,t)=>{},this.onConnectedToStack=e=>{},this.onSwitchTenant=(e,t)=>{}},this._resetEvents(),this._initializeCompleted=!1,this._initializeResolve=null,this._initializeTimeout=null,this._pluginId=globalThis?.pluginId||null,this._baseUrl=null,this._entityId=null,this._isBackground=!window.name,this._queuedMessages=[],this._headerBackCallbacks={},this.context={app:{locale:null,theme:null,host:{clientType:null},extra:null}},window.onunload=e=>{this.onUnLoaded(e)},window.name)try{this._configurePlugin(JSON.parse(window.name))}catch(e){this._configurePlugin({pluginId:window.name})}globalThis._setPluginId=this._setPluginId,globalThis._configurePlugin=this._configurePlugin}ignoreCall(e){this._sendMessage("wazo/EVENT_IGNORE_CALL",{call:e})}}new i;var n=s(7),a=s.n(n);const o="bridge/CONFIG_RETRIEVED";class r extends(a()){constructor(){super(...arguments),this.url="https://softphone.wazo.io",this.width=500,this.height=600,this.iframeCss={left:0,bottom:0},this.displayed=!1,this.wrapper=null,this.iframe=null,this.iframeLoaded=!1,this.session=null,this._pendingMessages=[]}onLinkEnabled(e){}onIFrameLoaded(){}onCallLocallyAnswered(e){}onCallEstablished(e){}onOutgoingCallMade(e){}onCallIncoming(e){}onCallRejected(e){}onCallEnded(e,t,s,i){}onCardSaved(e){}onCardCanceled(){}onAuthenticated(e){}onLoggedOut(){}onSearchOptions(e,t){this.onOptionsResults(e,[])}onDisplayLinkedOption(e){}onWazoContactSearch(e){}onAgentLoggedIn(){}onAgentLoggedOut(){}onAgentPaused(){}onAgentResumed(){}onLanguageChanged(e){}onCallHeld(){}onCallResumed(){}onCallMuted(){}onCallUnMuted(){}onDtmfSent(e){}onDirectTransfer(e){}onCreateIndirectTransfer(e){}onCancelIndirectTransfer(){}onConfirmIndirectTransfer(){}onIndirectCallMade(e){}onIndirectTransferDone(e){}onStartRecording(){}onStopRecording(){}onCallLogCreated(e){}onWebsocketMessage(e){}onUnHandledEvent(e){}init({url:e,width:t,height:s,server:i,port:n,language:a,wrapUpDuration:r,iframeCss:l,enableAgent:h=!0,tenantId:d,domainName:c,debug:u=!1,disableAutoLogin:g=!1}){if(this.url=e||this.url,this.width=t||this.width,this.height=s||this.height,this.iframeCss=l||this.iframeCss,this.displayed=!1,this.iframeLoaded=!1,this.iframeLoaded=!1,this._pendingMessages=[],window.addEventListener("message",this._onMessage.bind(this),!1),!i)throw new Error("`server` is not set");const p={server:i,disableAutoLogin:g};a&&(p.language=a),n&&(p.port=n),d&&(console.warn("Use of `tenantId` is deprecated when calling `Softphone.init()`, use `domainName` instead"),p.tenantId=d),c&&(p.domainName=c),r&&(p.wrapUpDuration=r),this._sendMessage(o,{config:p}),h&&this._sendMessage("bridge/BRIDGE_ENABLE_AGENT"),u&&this._sendMessage("bridge/BRIDGE_ENABLE_DEBUG"),this._createIframe((()=>{this.iframeLoaded=!0,this._pendingMessages.forEach((([e,t])=>this._sendMessage(e,t))),this.onIFrameLoaded()}))}parseLinks(){this._getLinks().forEach((e=>{e.setAttribute("data-wazo-parsed","true"),e.addEventListener("click",this._onLinkClick.bind(this)),this.onLinkEnabled(e)}))}removeParsedLinksEvent(){[].slice.call(document.querySelectorAll("a[data-wazo-parsed]"),0).forEach((e=>{e.removeAttribute("data-wazo-parsed"),e.removeEventListener("click",this._onLinkClick.bind(this))}))}makeCall(e){this.show(),this._sendMessage("bridge/ON_CLICK_TO_CALL",{number:e})}toggleDisplay(){this.displayed?this.hide():this.show()}show(){this.iframe||this._createIframe(),this.iframe&&(this.iframe.style.display="block"),this.displayed=!0,this.emit("show")}hide(){this.iframe&&(this.iframe.style.display="none"),this.displayed=!1,this.emit("hide")}remove(){this.iframe&&this.iframe.remove(),this.wrapper&&this.wrapper.remove(),this.iframe=null,this.wrapper=null}optionsFetched(e,t){this._sendMessage("bridge/BRIDGE_OPTIONS_FETCHED",{fieldId:e,options:t})}onOptionsResults(e,t){this._sendMessage("bridge/BRIDGE_OPTIONS_FOUND",{fieldId:e,options:t})}setFormSchema(e,t){this._sendMessage("bridge/BRIDGE_UPDATE_FORM_SCHEMA",{schema:e,uiSchema:t})}setCardValue(e,t){this._sendMessage("bridge/BRIDGE_SET_CARD_CONTENT",{field:e,value:t})}injectCss(e){this._sendMessage("bridge/BRIDGE_INJECT_CSS",{css:e})}customizeAppearance(e,t,s){this._sendMessage("bridge/BRIDGE_CUSTOMIZE_APPEARANCE",{themes:e,translations:t,assets:s})}loginWithToken(e,t){this._sendMessage("bridge/BRIDGE_LOGIN_WITH_TOKEN",{token:e,refreshToken:t})}configureServer(e){this._sendMessage(o,{config:{server:e}})}updateCss(e=null){e&&(this.wrapper&&Object.keys(e).forEach((t=>{this.wrapper.style[t]=e[t]})),this.iframeCss=e)}_createIframe(e){this.remove(),this.wrapper=document.createElement("div"),this.wrapper.id="iframe-wrapper",this.wrapper.style.position="fixed",this.updateCss(this.iframeCss),this.iframe=document.createElement("iframe"),this.iframe.width=String(this.width),this.iframe.height=String(this.height),this.iframe.allow="camera *; microphone *; autoplay *; display-capture *",this.iframe.style.border="1px solid #aaa",this.iframe.style.backgroundColor="white",this.iframe.style.display="none",this.iframe.src=this.url,this.iframe.id="wazo-softphone",e&&(this.iframe.onload=e),this.wrapper.appendChild(this.iframe),document.body.appendChild(this.wrapper)}_getLinks(){return[].slice.call(document.querySelectorAll("a:not([data-wazo-parsed])"),0).filter((e=>0===e.href.indexOf("tel:")||0===e.href.indexOf("callto:")))}_onLinkClick(e){e.preventDefault();const t=e.target.href.split("//")[1];this.makeCall(t)}_onAuthenticated(e){this.session=e,this.parseLinks()}_onMessage(e){if(e.data)switch(e.data.type){case"sdk/SDK_ON_OUTGOING_CALL_MADE":this.onOutgoingCallMade(e.data.callSession);break;case"sdk/ON_CALL_ENDED":{const{callSession:t,content:s,direction:i,userExtension:n}=e.data;this.onCallEnded(t,s,i,n);break}case"sdk/SDK_CALL_INCOMING":this.onCallIncoming(e.data.callSession);break;case"sdk/SDK_AUTHENTICATED":this._onAuthenticated(e.data.session),this.onAuthenticated(e.data.session);break;case"bridge/LOGGED_OUT":this.onLoggedOut();break;case"bridge/BRIDGE_CREATE_OR_UPDATE_CARD":{const{content:t}=e.data;this.onCardSaved(t);break}case"bridge/BRIDGE_SEARCH_OPTIONS":{const{fieldId:t,query:s}=e.data;this.onSearchOptions(t,s);break}case"bridge/DISPLAY_LINKED_OPTION":this.onDisplayLinkedOption(e.data.linkedOptionId);break;case"bridge/BRIDGE_WAZO_CONTACT_SEARCH":this.onWazoContactSearch(e.data.query);break;case"bridge/BRIDGE_ON_AGENT_LOGGED_IN":this.onAgentLoggedIn();break;case"bridge/BRIDGE_ON_AGENT_LOGGED_OUT":this.onAgentLoggedOut();break;case"bridge/BRIDGE_ON_AGENT_PAUSED":this.onAgentPaused();break;case"bridge/BRIDGE_ON_AGENT_RESUMED":this.onAgentResumed();break;case"bridge/BRIDGE_ON_LANGUAGE_CHANGED":this.onLanguageChanged(e.data.language);break;case"bridge/BRIDGE_ON_CALL_HELD":this.onCallHeld();break;case"bridge/BRIDGE_ON_CALL_RESUMED":this.onCallResumed();break;case"bridge/BRIDGE_ON_CALL_MUTED":this.onCallMuted();break;case"bridge/BRIDGE_ON_CALL_UN_MUTED":this.onCallUnMuted();break;case"bridge/BRIDGE_ON_DTMF":this.onDtmfSent(e.data.tone);break;case"bridge/BRIDGE_ON_DIRECT_TRANSFER":this.onDirectTransfer(e.data.number);break;case"bridge/BRIDGE_ON_CREATE_INDIRECT_TRANSFER":this.onCreateIndirectTransfer(e.data.number);break;case"bridge/BRIDGE_ON_CANCEL_INDIRECT_TRANSFER":this.onCancelIndirectTransfer();break;case"bridge/BRIDGE_ON_CONFIRM_INDIRECT_TRANSFER":this.onConfirmIndirectTransfer();break;case"bridge/BRIDGE_ON_INDIRECT_TRANSFER_CALL_MADE":this.onIndirectCallMade(e.data.call);break;case"bridge/BRIDGE_ON_INDIRECT_TRANSFER_DONE":this.onIndirectTransferDone(e.data.call);break;case"bridge/BRIDGE_ON_START_RECORDING":this.onStartRecording();break;case"bridge/BRIDGE_ON_STOP_RECORDING":this.onStopRecording();break;case"bridge/BRIDGE_ON_CARD_CANCELED":this.onCardCanceled();break;case"bridge/BRIDGE_ON_CALL_LOCALLY_ACCEPTED":this.onCallLocallyAnswered(e.data.call);break;case"bridge/BRIDGE_ON_CALL_REJECTED":this.onCallRejected(e.data.call);break;case"bridge/BRIDGE_ON_CALL_ESTABLISHED":this.onCallEstablished(e.data.call);break;case"bridge/BRIDGE_CALL_LOG_CREATED":this.onCallLogCreated(e.data.callLog);break;case"bridge/BRIDGE_ON_WEBSOCKET_MESSAGE":this.onWebsocketMessage(e.data.message);break;default:this.onUnHandledEvent(e)}}_sendMessage(e,t={}){this.iframe&&this.iframeLoaded?this.iframe&&this.iframe.contentWindow&&this.iframe.contentWindow.postMessage({type:e,...t},"*"):this._pendingMessages.push([e,t])}}new r;const l=e=>"string"==typeof e,h=()=>{let e,t;const s=new Promise(((s,i)=>{e=s,t=i}));return s.resolve=e,s.reject=t,s},d=e=>null==e?"":""+e,c=/###/g,u=e=>e&&e.indexOf("###")>-1?e.replace(c,"."):e,g=e=>!e||l(e),p=(e,t,s)=>{const i=l(t)?t.split("."):t;let n=0;for(;n<i.length-1;){if(g(e))return{};const t=u(i[n]);!e[t]&&s&&(e[t]=new s),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++n}return g(e)?{}:{obj:e,k:u(i[n])}},f=(e,t,s)=>{const{obj:i,k:n}=p(e,t,Object);if(void 0!==i||1===t.length)return void(i[n]=s);let a=t[t.length-1],o=t.slice(0,t.length-1),r=p(e,o,Object);for(;void 0===r.obj&&o.length;)a=`${o[o.length-1]}.${a}`,o=o.slice(0,o.length-1),r=p(e,o,Object),r?.obj&&void 0!==r.obj[`${r.k}.${a}`]&&(r.obj=void 0);r.obj[`${r.k}.${a}`]=s},m=(e,t)=>{const{obj:s,k:i}=p(e,t);if(s&&Object.prototype.hasOwnProperty.call(s,i))return s[i]},_=(e,t,s)=>{for(const i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?l(e[i])||e[i]instanceof String||l(t[i])||t[i]instanceof String?s&&(e[i]=t[i]):_(e[i],t[i],s):e[i]=t[i]);return e},v=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const E=e=>l(e)?e.replace(/[&<>"'\/]/g,(e=>y[e])):e,b=[" ",",","?","!",";"],L=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const s=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,s),this.regExpQueue.push(e),s}}(20),O=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const i=t.split(s);let n=e;for(let e=0;e<i.length;){if(!n||"object"!=typeof n)return;let t,a="";for(let o=e;o<i.length;++o)if(o!==e&&(a+=s),a+=i[o],t=n[a],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&o<i.length-1)continue;e+=o-e+1;break}n=t}return n},N=e=>e?.replace("_","-"),w={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class C{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||w,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,s,i){return i&&!this.debug?null:(l(e[0])&&(e[0]=`${s}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new C(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new C(this.logger,e)}}var S=new C;class k{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const s=this.observers[e].get(t)||0;this.observers[e].set(t,s+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach((e=>{let[t,i]=e;for(let e=0;e<i;e++)t(...s)})),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach((t=>{let[i,n]=t;for(let t=0;t<n;t++)i.apply(i,[e,...s])}))}}class x extends k{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,a=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],s&&(Array.isArray(s)?o.push(...s):l(s)&&n?o.push(...s.split(n)):o.push(s)));const r=m(this.data,o);return!r&&!t&&!s&&e.indexOf(".")>-1&&(e=o[0],t=o[1],s=o.slice(2).join(".")),!r&&a&&l(s)?O(this.data?.[e]?.[t],s,n):r}addResource(e,t,s,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const a=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator;let o=[e,t];s&&(o=o.concat(a?s.split(a):s)),e.indexOf(".")>-1&&(o=e.split("."),i=t,t=o[1]),this.addNamespaces(t),f(this.data,o,i),n.silent||this.emit("added",e,t,s,i)}addResources(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const i in s)(l(s[i])||Array.isArray(s[i]))&&this.addResource(e,t,i,s[i],{silent:!0});i.silent||this.emit("added",e,t,s)}addResourceBundle(e,t,s,i,n){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),i=s,s=t,t=o[1]),this.addNamespaces(t);let r=m(this.data,o)||{};a.skipCopy||(s=JSON.parse(JSON.stringify(s))),i?_(r,s,n):r={...r,...s},f(this.data,o,r),a.silent||this.emit("added",e,t,s)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var R={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,s,i,n){return e.forEach((e=>{t=this.processors[e]?.process(t,s,i,n)??t})),t}};const I={},T=e=>!l(e)&&"boolean"!=typeof e&&"number"!=typeof e;class A extends k{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;super(),s=e,i=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((e=>{s[e]&&(i[e]=s[e])})),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=S.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;const s=this.resolve(e,t);return void 0!==s?.res}extractFromKey(e,t){let s=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===s&&(s=":");const i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let n=t.ns||this.options.defaultNS||[];const a=s&&e.indexOf(s)>-1,o=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,s)=>{t=t||"",s=s||"";const i=b.filter((e=>t.indexOf(e)<0&&s.indexOf(e)<0));if(0===i.length)return!0;const n=L.getRegExp(`(${i.map((e=>"?"===e?"\\?":e)).join("|")})`);let a=!n.test(e);if(!a){const t=e.indexOf(s);t>0&&!n.test(e.substring(0,t))&&(a=!0)}return a})(e,s,i));if(a&&!o){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:l(n)?[n]:n};const a=e.split(s);(s!==i||s===i&&this.options.ns.indexOf(a[0])>-1)&&(n=a.shift()),e=a.join(i)}return{key:e,namespaces:l(n)?[n]:n}}translate(e,t,s){if("object"!=typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof t&&(t={...t}),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const i=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:a,namespaces:o}=this.extractFromKey(e[e.length-1],t),r=o[o.length-1],h=t.lng||this.language,d=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===h?.toLowerCase()){if(d){const e=t.nsSeparator||this.options.nsSeparator;return i?{res:`${r}${e}${a}`,usedKey:a,exactUsedKey:a,usedLng:h,usedNS:r,usedParams:this.getUsedParamsDetails(t)}:`${r}${e}${a}`}return i?{res:a,usedKey:a,exactUsedKey:a,usedLng:h,usedNS:r,usedParams:this.getUsedParamsDetails(t)}:a}const c=this.resolve(e,t);let u=c?.res;const g=c?.usedKey||a,p=c?.exactUsedKey||a,f=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,_=void 0!==t.count&&!l(t.count),v=A.hasDefaultValue(t),y=_?this.pluralResolver.getSuffix(h,t.count,t):"",E=t.ordinal&&_?this.pluralResolver.getSuffix(h,t.count,{ordinal:!1}):"",b=_&&!t.ordinal&&0===t.count,L=b&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${y}`]||t[`defaultValue${E}`]||t.defaultValue;let O=u;m&&!u&&v&&(O=L);const N=T(O),w=Object.prototype.toString.apply(O);if(!(m&&O&&N&&["[object Number]","[object Function]","[object RegExp]"].indexOf(w)<0)||l(f)&&Array.isArray(O))if(m&&l(f)&&Array.isArray(u))u=u.join(f),u&&(u=this.extendTranslation(u,e,t,s));else{let i=!1,o=!1;!this.isValidLookup(u)&&v&&(i=!0,u=L),this.isValidLookup(u)||(o=!0,u=a);const l=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:u,d=v&&L!==u&&this.options.updateMissing;if(o||i||d){if(this.logger.log(d?"updateKey":"missingKey",h,r,a,d?L:u),n){const e=this.resolve(a,{...t,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const s=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&s&&s[0])for(let t=0;t<s.length;t++)e.push(s[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);const i=(e,s,i)=>{const n=v&&i!==u?i:l;this.options.missingKeyHandler?this.options.missingKeyHandler(e,r,s,n,d,t):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,r,s,n,d,t),this.emit("missingKey",e,r,s,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?e.forEach((e=>{const s=this.pluralResolver.getSuffixes(e,t);b&&t[`defaultValue${this.options.pluralSeparator}zero`]&&s.indexOf(`${this.options.pluralSeparator}zero`)<0&&s.push(`${this.options.pluralSeparator}zero`),s.forEach((s=>{i([e],a+s,t[`defaultValue${s}`]||L)}))})):i(e,a,L))}u=this.extendTranslation(u,e,t,c,s),o&&u===a&&this.options.appendNamespaceToMissingKey&&(u=`${r}:${a}`),(o||i)&&this.options.parseMissingKeyHandler&&(u=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${r}:${a}`:a,i?u:void 0))}else{if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,O,{...t,ns:o}):`key '${a} (${this.language})' returned an object instead of string.`;return i?(c.res=e,c.usedParams=this.getUsedParamsDetails(t),c):e}if(n){const e=Array.isArray(O),s=e?[]:{},i=e?p:g;for(const e in O)if(Object.prototype.hasOwnProperty.call(O,e)){const a=`${i}${n}${e}`;s[e]=v&&!u?this.translate(a,{...t,defaultValue:T(L)?L[e]:void 0,joinArrays:!1,ns:o}):this.translate(a,{...t,joinArrays:!1,ns:o}),s[e]===a&&(s[e]=O[e])}u=s}}return i?(c.res=u,c.usedParams=this.getUsedParamsDetails(t),c):u}extendTranslation(e,t,s,i,n){var a=this;if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const o=l(e)&&(void 0!==s?.interpolation?.skipOnVariables?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let r;if(o){const t=e.match(this.interpolator.nestingRegexp);r=t&&t.length}let h=s.replace&&!l(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),e=this.interpolator.interpolate(e,h,s.lng||this.language||i.usedLng,s),o){const t=e.match(this.interpolator.nestingRegexp);r<(t&&t.length)&&(s.nest=!1)}!s.lng&&i&&i.res&&(s.lng=this.language||i.usedLng),!1!==s.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return n?.[0]!==i[0]||s.context?a.translate(...i,t):(a.logger.warn(`It seems you are nesting recursively key: ${i[0]} in key: ${t[0]}`),null)}),s)),s.interpolation&&this.interpolator.reset()}const o=s.postProcess||this.options.postProcess,r=l(o)?[o]:o;return null!=e&&r?.length&&!1!==s.applyPostProcessor&&(e=R.handle(r,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),e}resolve(e){let t,s,i,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(t))return;const r=this.extractFromKey(e,o),h=r.key;s=h;let d=r.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const c=void 0!==o.count&&!l(o.count),u=c&&!o.ordinal&&0===o.count,g=void 0!==o.context&&(l(o.context)||"number"==typeof o.context)&&""!==o.context,p=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);d.forEach((e=>{this.isValidLookup(t)||(a=e,I[`${p[0]}-${e}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(a)||(I[`${p[0]}-${e}`]=!0,this.logger.warn(`key "${s}" for languages "${p.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((s=>{if(this.isValidLookup(t))return;n=s;const a=[h];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(a,h,s,e,o);else{let e;c&&(e=this.pluralResolver.getSuffix(s,o.count,o));const t=`${this.options.pluralSeparator}zero`,i=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(a.push(h+e),o.ordinal&&0===e.indexOf(i)&&a.push(h+e.replace(i,this.options.pluralSeparator)),u&&a.push(h+t)),g){const s=`${h}${this.options.contextSeparator}${o.context}`;a.push(s),c&&(a.push(s+e),o.ordinal&&0===e.indexOf(i)&&a.push(s+e.replace(i,this.options.pluralSeparator)),u&&a.push(s+t))}}let r;for(;r=a.pop();)this.isValidLookup(t)||(i=r,t=this.getResource(s,e,r,o))})))}))})),{res:t,usedKey:s,exactUsedKey:i,usedLng:n,usedNS:a}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,s,i):this.resourceStore.getResource(e,t,s,i)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=e.replace&&!l(e.replace);let i=s?e.replace:e;if(s&&void 0!==e.count&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!s){i={...i};for(const e of t)delete i[e]}return i}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}class M{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=S.create("languageUtils")}getScriptPartFromCode(e){if(!(e=N(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=N(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(l(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const s=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(s)||(t=s)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const s=this.getLanguagePartFromCode(e);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find((e=>e===s?e:e.indexOf("-")<0&&s.indexOf("-")<0?void 0:e.indexOf("-")>0&&s.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===s||0===e.indexOf(s)&&s.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),l(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let s=e[t];return s||(s=e[this.getScriptPartFromCode(t)]),s||(s=e[this.formatLanguageCode(t)]),s||(s=e[this.getLanguagePartFromCode(t)]),s||(s=e.default),s||[]}toResolveHierarchy(e,t){const s=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],n=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return l(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(e))):l(e)&&n(this.formatLanguageCode(e)),s.forEach((e=>{i.indexOf(e)<0&&n(this.formatLanguageCode(e))})),i}}const D={zero:0,one:1,two:2,few:3,many:4,other:5},P={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class B{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=S.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=N("dev"===e?"en":e),i=t.ordinal?"ordinal":"cardinal",n=JSON.stringify({cleanedCode:s,type:i});if(n in this.pluralRulesCache)return this.pluralRulesCache[n];let a;try{a=new Intl.PluralRules(s,{type:i})}catch(s){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),P;if(!e.match(/-|_/))return P;const i=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(i,t)}return this.pluralRulesCache[n]=a,a}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.getRule(e,t);return s||(s=this.getRule("dev",t)),s?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,s).map((e=>`${t}${e}`))}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.getRule(e,t);return s||(s=this.getRule("dev",t)),s?s.resolvedOptions().pluralCategories.sort(((e,t)=>D[e]-D[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):[]}getSuffix(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getRule(e,s);return i?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,s))}}const V=function(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=((e,t,s)=>{const i=m(e,s);return void 0!==i?i:m(t,s)})(e,t,s);return!a&&n&&l(s)&&(a=O(e,s,i),void 0===a&&(a=O(t,s,i))),a},$=e=>e.replace(/\$/g,"$$$$");class U{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=S.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:s,useRawValueToEscape:i,prefix:n,prefixEscaped:a,suffix:o,suffixEscaped:r,formatSeparator:l,unescapeSuffix:h,unescapePrefix:d,nestingPrefix:c,nestingPrefixEscaped:u,nestingSuffix:g,nestingSuffixEscaped:p,nestingOptionsSeparator:f,maxReplaces:m,alwaysFormat:_}=e.interpolation;this.escape=void 0!==t?t:E,this.escapeValue=void 0===s||s,this.useRawValueToEscape=void 0!==i&&i,this.prefix=n?v(n):a||"{{",this.suffix=o?v(o):r||"}}",this.formatSeparator=l||",",this.unescapePrefix=h?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=c?v(c):u||v("$t("),this.nestingSuffix=g?v(g):p||v(")"),this.nestingOptionsSeparator=f||",",this.maxReplaces=m||1e3,this.alwaysFormat=void 0!==_&&_,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e?.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,s,i){let n,a,o;const r=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},h=e=>{if(e.indexOf(this.formatSeparator)<0){const n=V(t,r,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(n,void 0,s,{...i,...t,interpolationkey:e}):n}const n=e.split(this.formatSeparator),a=n.shift().trim(),o=n.join(this.formatSeparator).trim();return this.format(V(t,r,a,this.options.keySeparator,this.options.ignoreJSONStructure),o,s,{...i,...t,interpolationkey:a})};this.resetRegExp();const c=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,u=void 0!==i?.interpolation?.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>$(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?$(this.escape(e)):$(e)}].forEach((t=>{for(o=0;n=t.regex.exec(e);){const s=n[1].trim();if(a=h(s),void 0===a)if("function"==typeof c){const t=c(e,n,i);a=l(t)?t:""}else if(i&&Object.prototype.hasOwnProperty.call(i,s))a="";else{if(u){a=n[0];continue}this.logger.warn(`missed to pass in variable ${s} for interpolating ${e}`),a=""}else l(a)||this.useRawValueToEscape||(a=d(a));const r=t.safeValue(a);if(e=e.replace(n[0],r),u?(t.regex.lastIndex+=a.length,t.regex.lastIndex-=n[0].length):t.regex.lastIndex=0,o++,o>=this.maxReplaces)break}})),e}nest(e,t){let s,i,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=(e,t)=>{const s=this.nestingOptionsSeparator;if(e.indexOf(s)<0)return e;const i=e.split(new RegExp(`${s}[ ]*{`));let a=`{${i[1]}`;e=i[0],a=this.interpolate(a,n);const o=a.match(/'/g),r=a.match(/"/g);((o?.length??0)%2==0&&!r||r.length%2!=0)&&(a=a.replace(/'/g,'"'));try{n=JSON.parse(a),t&&(n={...t,...n})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${s}${a}`}return n.defaultValue&&n.defaultValue.indexOf(this.prefix)>-1&&delete n.defaultValue,e};for(;s=this.nestingRegexp.exec(e);){let r=[];n={...a},n=n.replace&&!l(n.replace)?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let h=!1;if(-1!==s[0].indexOf(this.formatSeparator)&&!/{.*}/.test(s[1])){const e=s[1].split(this.formatSeparator).map((e=>e.trim()));s[1]=e.shift(),r=e,h=!0}if(i=t(o.call(this,s[1].trim(),n),n),i&&s[0]===e&&!l(i))return i;l(i)||(i=d(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),i=""),h&&(i=r.reduce(((e,t)=>this.format(e,t,a.lng,{...a,interpolationkey:s[1].trim()})),i.trim())),e=e.replace(s[0],i),this.regexp.lastIndex=0}return e}}const z=e=>{const t={};return(s,i,n)=>{let a=n;n&&n.interpolationkey&&n.formatParams&&n.formatParams[n.interpolationkey]&&n[n.interpolationkey]&&(a={...a,[n.interpolationkey]:void 0});const o=i+JSON.stringify(a);let r=t[o];return r||(r=e(N(i),n),t[o]=r),r(s)}};class j{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=S.create("formatter"),this.options=e,this.formats={number:z(((e,t)=>{const s=new Intl.NumberFormat(e,{...t});return e=>s.format(e)})),currency:z(((e,t)=>{const s=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>s.format(e)})),datetime:z(((e,t)=>{const s=new Intl.DateTimeFormat(e,{...t});return e=>s.format(e)})),relativetime:z(((e,t)=>{const s=new Intl.RelativeTimeFormat(e,{...t});return e=>s.format(e,t.range||"day")})),list:z(((e,t)=>{const s=new Intl.ListFormat(e,{...t});return e=>s.format(e)}))},this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=z(t)}format(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=t.split(this.formatSeparator);if(n.length>1&&n[0].indexOf("(")>1&&n[0].indexOf(")")<0&&n.find((e=>e.indexOf(")")>-1))){const e=n.findIndex((e=>e.indexOf(")")>-1));n[0]=[n[0],...n.splice(1,e)].join(this.formatSeparator)}return n.reduce(((e,t)=>{const{formatName:n,formatOptions:a}=(e=>{let t=e.toLowerCase().trim();const s={};if(e.indexOf("(")>-1){const i=e.split("(");t=i[0].toLowerCase().trim();const n=i[1].substring(0,i[1].length-1);"currency"===t&&n.indexOf(":")<0?s.currency||(s.currency=n.trim()):"relativetime"===t&&n.indexOf(":")<0?s.range||(s.range=n.trim()):n.split(";").forEach((e=>{if(e){const[t,...i]=e.split(":"),n=i.join(":").trim().replace(/^'+|'+$/g,""),a=t.trim();s[a]||(s[a]=n),"false"===n&&(s[a]=!1),"true"===n&&(s[a]=!0),isNaN(n)||(s[a]=parseInt(n,10))}}))}return{formatName:t,formatOptions:s}})(t);if(this.formats[n]){let t=e;try{const o=i?.formatParams?.[i.interpolationkey]||{},r=o.locale||o.lng||i.locale||i.lng||s;t=this.formats[n](e,r,{...a,...i,...o})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${n}`),e}),e)}}class G extends k{constructor(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=s,this.languageUtils=s.languageUtils,this.options=i,this.logger=S.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(s,i.backend,i)}queueLoad(e,t,s,i){const n={},a={},o={},r={};return e.forEach((e=>{let i=!0;t.forEach((t=>{const o=`${e}|${t}`;!s.reload&&this.store.hasResourceBundle(e,t)?this.state[o]=2:this.state[o]<0||(1===this.state[o]?void 0===a[o]&&(a[o]=!0):(this.state[o]=1,i=!1,void 0===a[o]&&(a[o]=!0),void 0===n[o]&&(n[o]=!0),void 0===r[t]&&(r[t]=!0)))})),i||(o[e]=!0)})),(Object.keys(n).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(n),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(r)}}loaded(e,t,s){const i=e.split("|"),n=i[0],a=i[1];t&&this.emit("failedLoading",n,a,t),!t&&s&&this.store.addResourceBundle(n,a,s,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&s&&(this.state[e]=0);const o={};this.queue.forEach((s=>{((e,t,s,i)=>{const{obj:n,k:a}=p(e,t,Object);n[a]=n[a]||[],n[a].push(s)})(s.loaded,[n],a),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(s,e),t&&s.errors.push(t),0!==s.pendingCount||s.done||(Object.keys(s.loaded).forEach((e=>{o[e]||(o[e]={});const t=s.loaded[e];t.length&&t.forEach((t=>{void 0===o[e][t]&&(o[e][t]=!0)}))})),s.done=!0,s.errors.length?s.callback(s.errors):s.callback())})),this.emit("loaded",o),this.queue=this.queue.filter((e=>!e.done))}read(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:s,tried:i,wait:n,callback:a});this.readingCalls++;const o=(o,r)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}o&&r&&i<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,s,i+1,2*n,a)}),n):a(o,r)},r=this.backend[s].bind(this.backend);if(2!==r.length)return r(e,t,o);try{const s=r(e,t);s&&"function"==typeof s.then?s.then((e=>o(null,e))).catch(o):o(null,s)}catch(e){o(e)}}prepareLoading(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();l(e)&&(e=this.languageUtils.toResolveHierarchy(e)),l(t)&&(t=[t]);const n=this.queueLoad(e,t,s,i);if(!n.toLoad.length)return n.pending.length||i(),null;n.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,s){this.prepareLoading(e,t,{},s)}reload(e,t,s){this.prepareLoading(e,t,{reload:!0},s)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=e.split("|"),i=s[0],n=s[1];this.read(i,n,"read",void 0,void 0,((s,a)=>{s&&this.logger.warn(`${t}loading namespace ${n} for language ${i} failed`,s),!s&&a&&this.logger.log(`${t}loaded namespace ${n} for language ${i}`,a),this.loaded(e,s,a)}))}saveMissing(e,t,s,i,n){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(t)){if(null!=s&&""!==s){if(this.backend?.create){const r={...a,isUpdate:n},l=this.backend.create.bind(this.backend);if(l.length<6)try{let n;n=5===l.length?l(e,t,s,i,r):l(e,t,s,i),n&&"function"==typeof n.then?n.then((e=>o(null,e))).catch(o):o(null,n)}catch(e){o(e)}else l(e,t,s,i,o,r)}e&&e[0]&&this.store.addResource(e[0],t,s,i)}}else this.logger.warn(`did not save key "${s}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const F=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),l(e[1])&&(t.defaultValue=e[1]),l(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const s=e[3]||e[2];Object.keys(s).forEach((e=>{t[e]=s[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),H=e=>(l(e.ns)&&(e.ns=[e.ns]),l(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),l(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),K=()=>{};class W extends k{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var s;if(super(),this.options=H(e),this.services={},this.logger=S,this.modules={external:[]},s=this,Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach((e=>{"function"==typeof s[e]&&(s[e]=s[e].bind(s))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof t&&(s=t,t={}),null==t.defaultNS&&t.ns&&(l(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const i=F();this.options={...i,...this.options,...H(t)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);const n=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?S.init(n(this.modules.logger),this.options):S.init(null,this.options),t=this.modules.formatter?this.modules.formatter:j;const s=new M(this.options);this.store=new x(this.options.resources,this.options);const a=this.services;a.logger=S,a.resourceStore=this.store,a.languageUtils=s,a.pluralResolver=new B(s,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!t||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(a.formatter=n(t),a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new U(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new G(n(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),n=1;n<s;n++)i[n-1]=arguments[n];e.emit(t,...i)})),this.modules.languageDetector&&(a.languageDetector=n(this.modules.languageDetector),a.languageDetector.init&&a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=n(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new A(this.services,this.options),this.translator.on("*",(function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),n=1;n<s;n++)i[n-1]=arguments[n];e.emit(t,...i)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,s||(s=K),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((t=>{this[t]=function(){return e.store[t](...arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((t=>{this[t]=function(){return e.store[t](...arguments),e}}));const a=h(),o=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(t),s(e,t)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?o():setTimeout(o,0),a}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;const s=l(e)?e:this.language;if("function"==typeof e&&(t=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===s?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return t();const e=[],i=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};s?i(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>i(e))),this.options.preload?.forEach?.((e=>i(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),t(e)}))}else t(null)}reloadResources(e,t,s){const i=h();return"function"==typeof e&&(s=e,e=void 0),"function"==typeof t&&(s=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),s||(s=K),this.services.backendConnector.reload(e,t,(e=>{i.resolve(),s(e)})),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&R.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(e,t){var s=this;this.isLanguageChangingTo=e;const i=h();this.emit("languageChanging",e);const n=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},a=(e,a)=>{a?(n(a),this.translator.changeLanguage(a),this.isLanguageChangingTo=void 0,this.emit("languageChanged",a),this.logger.log("languageChanged",a)):this.isLanguageChangingTo=void 0,i.resolve((function(){return s.t(...arguments)})),t&&t(e,(function(){return s.t(...arguments)}))},o=t=>{e||t||!this.services.languageDetector||(t=[]);const s=l(t)?t:this.services.languageUtils.getBestMatchFromCodes(t);s&&(this.language||n(s),this.translator.language||this.translator.changeLanguage(s),this.services.languageDetector?.cacheUserLanguage?.(s)),this.loadResources(s,(e=>{a(e,s)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e):o(this.services.languageDetector.detect()),i}getFixedT(e,t,s){var i=this;const n=function(e,t){let a;if("object"!=typeof t){for(var o=arguments.length,r=new Array(o>2?o-2:0),l=2;l<o;l++)r[l-2]=arguments[l];a=i.options.overloadTranslationOptionHandler([e,t].concat(r))}else a={...t};a.lng=a.lng||n.lng,a.lngs=a.lngs||n.lngs,a.ns=a.ns||n.ns,""!==a.keyPrefix&&(a.keyPrefix=a.keyPrefix||s||n.keyPrefix);const h=i.options.keySeparator||".";let d;return d=a.keyPrefix&&Array.isArray(e)?e.map((e=>`${a.keyPrefix}${h}${e}`)):a.keyPrefix?`${a.keyPrefix}${h}${e}`:e,i.t(d,a)};return l(e)?n.lng=e:n.lngs=e,n.ns=t,n.keyPrefix=s,n}t(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.translator?.translate(...t)}exists(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.translator?.exists(...t)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=t.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,n=this.languages[this.languages.length-1];if("cimode"===s.toLowerCase())return!0;const a=(e,t)=>{const s=this.services.backendConnector.state[`${e}|${t}`];return-1===s||0===s||2===s};if(t.precheck){const e=t.precheck(this,a);if(void 0!==e)return e}return!(!this.hasResourceBundle(s,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!a(s,e)||i&&!a(n,e)))}loadNamespaces(e,t){const s=h();return this.options.ns?(l(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{s.resolve(),t&&t(e)})),s):(t&&t(),Promise.resolve())}loadLanguages(e,t){const s=h();l(e)&&(e=[e]);const i=this.options.preload||[],n=e.filter((e=>i.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return n.length?(this.options.preload=i.concat(n),this.loadResources((e=>{s.resolve(),t&&t(e)})),s):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services?.languageUtils||new M(F());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new W(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;const s=e.forkResourceStore;s&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},n=new W(i);if(void 0===e.debug&&void 0===e.prefix||(n.logger=n.logger.clone(e)),["store","services","language"].forEach((e=>{n[e]=this[e]})),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},s){const e=Object.keys(this.store.data).reduce(((e,t)=>(e[t]={...this.store.data[t]},Object.keys(e[t]).reduce(((s,i)=>(s[i]={...e[t][i]},s)),{}))),{});n.store=new x(e,i),n.services.resourceStore=n.store}return n.translator=new A(n.services,i),n.translator.on("*",(function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];n.emit(e,...s)})),n.init(i,t),n.translator.options=i,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const J=W.createInstance();let q,Y;J.createInstance=W.createInstance,J.createInstance,J.dir,J.init,J.loadResources,J.reloadResources,J.use,J.changeLanguage,J.getFixedT,J.t,J.exists,J.setDefaultNamespace,J.hasLoadedNamespace,J.loadNamespaces,J.loadLanguages,s(893);const Q=new i,Z=document.getElementById("ring-internal"),X=document.getElementById("playButton-internal"),ee=document.getElementById("stopButton-internal"),te=document.getElementById("ring-external"),se=document.getElementById("playButton-external"),ie=document.getElementById("stopButton-external"),ne={original:"Reset to original","iphone.mp3":"Iphone","iphone6.mp3":"Iphone 6","landline1.wav":"Landline 1","landline2.wav":"Landline 2","marimba.wav":"Marimba 1","marimba.mp3":"Marimba 2","ring3.wav":"Ring 3","ring4.wav":"Ring 4","ring5.wav":"Ring 5","bird2.mp3":"Bird","sf-oiseau-24.mp3":"Bird 1","oiseau2.mp3":"Bird 2","sf_oiseau_seul_01.mp3":"Bird 3","sf_oiseaux.mp3":"Bird 4","sf_canari.mp3":"Canary","lg_bubble.mp3":"Bubble","huawei.mp3":"Huawei","lg_peanut.mp3":"Peanut","xylo.mp3":"Xylophone"};Q.onIframeMessage=e=>{if("config"===e.value){if(e.ringInternal){const t=e.ringInternal.split("/").pop();Z.value=t}if(e.ringExternal){const t=e.ringExternal.split("/").pop();te.value=t}}};const ae=(e,t)=>{const s=document.getElementById(t);for(const t in e){const i=document.createElement("option");i.text=e[t],i.value=t,s.add(i)}},oe=e=>{q=new Audio(e),q.play()},re=()=>{q&&q.pause()};(async()=>{await Q.initialize();const e=Q.getContext(),t=e.app.locale;Y=e.app.extra.baseUrl,ae(ne,"ring-internal"),ae(ne,"ring-external"),Z.addEventListener("change",(function(){const e=Z.value;Q.sendMessageToBackground({value:"ring",type:"internal",data:e}),re()})),X.addEventListener("click",(()=>{const e=Z.value,t=`${Y}/sounds/${e}`;re(),oe(t)})),ee.addEventListener("click",(()=>{re()})),te.addEventListener("change",(function(){const e=te.value;Q.sendMessageToBackground({value:"ring",type:"external",data:e}),re()})),se.addEventListener("click",(()=>{const e=te.value,t=`${Y}/sounds/${e}`;re(),oe(t)})),ie.addEventListener("click",(()=>{re()})),Q.sendMessageToBackground({value:"config"}),await J.init({lng:t,fallbackLng:"en",debug:!1,resources:{en:{translation:{ring_internal:"Internal calls ringtone",ring_external:"External calls ringtone"}},fr:{translation:{ring_internal:"Sonnerie appels internes",ring_external:"Sonnerie appels externes"}}}}),document.getElementById("label-internal").innerHTML=J.t("ring_internal"),document.getElementById("label-external").innerHTML=J.t("ring_external")})()})()})();
//# sourceMappingURL=ring.js.map